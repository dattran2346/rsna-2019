#############################################
# se_resnext50_32x4d
#############################################
# run inference on val
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 0 --resume models_collections/resnext50_32x4d_fold0_x256_bilstm/best_model.pth  --checkname val_resnext50_32x4d_fold0_x256_tta3 --tta 3
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 1 --resume models_collections/resnext50_32x4d_fold1_x256_bilstm/best_model.pth  --checkname val_resnext50_32x4d_fold1_x256_tta3 --tta 3
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 2 --resume models_collections/resnext50_32x4d_fold2_x256_bilstm/best_model.pth  --checkname val_resnext50_32x4d_fold2_x256_tta3 --tta 3
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 3 --resume models_collections/resnext50_32x4d_fold3_x256_bilstm/best_model.pth  --checkname val_resnext50_32x4d_fold3_x256_tta3 --tta 3
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 4 --resume models_collections/resnext50_32x4d_fold4_x256_bilstm/best_model.pth  --checkname val_resnext50_32x4d_fold4_x256_tta3 --tta 3

# run inference on test
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 0 --resume models_collections/resnext50_32x4d_fold0_x256_bilstm/best_model.pth  --checkname test_resnext50_32x4d_fold0_x256_tta3 --tta 3
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 1 --resume models_collections/resnext50_32x4d_fold1_x256_bilstm/best_model.pth  --checkname test_resnext50_32x4d_fold1_x256_tta3 --tta 3
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 2 --resume models_collections/resnext50_32x4d_fold2_x256_bilstm/best_model.pth  --checkname test_resnext50_32x4d_fold2_x256_tta3 --tta 3
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 3 --resume models_collections/resnext50_32x4d_fold3_x256_bilstm/best_model.pth  --checkname test_resnext50_32x4d_fold3_x256_tta3 --tta 3
# python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 4 --resume models_collections/resnext50_32x4d_fold4_x256_bilstm/best_model.pth  --checkname test_resnext50_32x4d_fold4_x256_tta3 --tta 3


#############################################
# se_resnext101_32x4d
#############################################
# run inference on val
## python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 0 --resume models_collections/resnext101_32x4d_fold0_x384_bilstm/best_model.pth  --checkname val_resnext101_32x4d_fold0_x384_tta3 --tta 3
## CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 1 --resume models_collections/resnext101_32x4d_fold1_x384_bilstm/best_model.pth  --checkname val_resnext101_32x4d_fold1_x384_tta3 --tta 3
## CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir "$HOME/dattran/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 2 --resume runs/resnext101_32x4d_fold2_x384_bilstm/best_model.pth  --checkname val_resnext101_32x4d_fold2_x384_tta3 --tta 3
## CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir "$HOME/dattran/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 3 --resume runs/resnext101_32x4d_fold3_x384_bilstm/best_model.pth  --checkname val_resnext101_32x4d_fold3_x384_tta3 --tta 3
# CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir "$HOME/dattran/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --val --infer-sigmoid --fold 4 --resume runs/resnext101_32x4d_fold4_x384_bilstm/best_model.pth  --checkname val_resnext101_32x4d_fold4_x384_tta3 --tta 3

# run inference on test
## python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 0 --resume models_collections/resnext101_32x4d_fold0_x384_bilstm/best_model.pth  --checkname test_resnext101_32x4d_fold0_x384_tta3 --tta 3
## CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir "$HOME/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 1 --resume models_collections/resnext101_32x4d_fold1_x384_bilstm/best_model.pth  --checkname test_resnext101_32x4d_fold1_x384_tta3 --tta 3
# CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir "$HOME/dattran/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 2 --resume runs/resnext101_32x4d_fold2_x384_bilstm/best_model.pth  --checkname test_resnext101_32x4d_fold2_x384_tta3 --tta 3
## CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir "$HOME/dattran/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 3 --resume runs/resnext101_32x4d_fold3_x384_bilstm/best_model.pth  --checkname test_resnext101_32x4d_fold3_x384_tta3 --tta 3
# CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir "$HOME/dattran/data/rsna" --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 4 --resume runs/resnext101_32x4d_fold4_x384_bilstm/best_model.pth  --checkname test_resnext101_32x4d_fold4_x384_tta3 --tta 3


#############################################
# se_resnext50_32x4d x256 on stage 2 test dataset
#############################################
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 0 --resume models_collections/resnext50_32x4d_fold0_x256_bilstm/best_model.pth --checkname test2_resnext50_32x4d_fold0_x256_tta3 --tta 3
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 1 --resume models_collections/resnext50_32x4d_fold1_x256_bilstm/best_model.pth --checkname test2_resnext50_32x4d_fold1_x256_tta3 --tta 3
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 2 --resume models_collections/resnext50_32x4d_fold2_x256_bilstm/best_model.pth --checkname test2_resnext50_32x4d_fold2_x256_tta3 --tta 3
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 3 --resume models_collections/resnext50_32x4d_fold3_x256_bilstm/best_model.pth --checkname test2_resnext50_32x4d_fold3_x256_tta3 --tta 3
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext50_32x4d' --att 'se' --image-size 256 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 4 --resume models_collections/resnext50_32x4d_fold4_x256_bilstm/best_model.pth --checkname test2_resnext50_32x4d_fold4_x256_tta3 --tta 3

#############################################
# se_resnext101_32x4d x384 on stage 2 test dataset
#############################################
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 0 --resume models_collections/resnext101_32x4d_fold0_x384_bilstm/best_model.pth --checkname test2_resnext101_32x4d_fold0_x384_tta3 --tta 3
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 1 --resume models_collections/resnext101_32x4d_fold1_x384_bilstm/best_model.pth --checkname test2_resnext101_32x4d_fold1_x384_tta3 --tta 3
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 2 --resume models_collections/resnext101_32x4d_fold2_x384_bilstm/best_model.pth --checkname test2_resnext101_32x4d_fold2_x384_tta3 --tta 3
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 3 --resume models_collections/resnext101_32x4d_fold3_x384_bilstm/best_model.pth --checkname test2_resnext101_32x4d_fold3_x384_tta3 --tta 3
CUDA_VISIBLE_DEVICES=$1 python3 inference.py --data-dir 'data/rsna' --mix-window 3 --backbone 'resnext101_32x4d' --att 'se' --image-size 384 --batch-size 128 --input-level "per-study" --infer-sigmoid --fold 4 --resume models_collections/resnext101_32x4d_fold4_x384_bilstm/best_model.pth --checkname test2_resnext101_32x4d_fold4_x384_tta3 --tta 3